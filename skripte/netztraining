import torch
from torch.utils.data import DataLoader
from torch import nn
import pickle
import numpy as np

training_liste = []
test_liste = []
zaehler = 0
bewertungen = {}

dateiliste = ['../reversi' + str(i) + '.of' for i in range(128)]
for datei in datei_liste:
    with (open(datei,'rb')) as f:
        bewertungen = pickle.load(f)
    for stellung_bytes in bewertungen.keys():
        stellung = np.frombuffer(stellung_bytes, dtype=np.int8)
        bewertung = bewertungen[stellung_bytes][0]/bewertungen[stellung_bytes][1]
        if not zaehler % 2:
            trainig_liste.append((torch.from_numpy(stellung), torch.tensor(bewertung)))
        else:
            test_liste.append((torch.from_numpy(stellung), torch.tensor(bewertung)))
        zaehler += 1


training_daten = Bewertungsdaten(training_liste)
test_daten = Bewertungsdaten(test_liste)
training_datengeber = DataLoader(training_daten, batch_size=1024, shuffle=True)
test_datengeber = DataLoader(test_daten, batch_size=1024, shuffle=True)

